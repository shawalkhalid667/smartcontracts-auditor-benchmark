{"language": "Solidity", "sources": {"bad_randomness_random_number_generator.sol": {"content": "/*\n * @source: https://github.com/SmartContractSecurity/SWC-registry/blob/master/test_cases/weak_randomness/random_number_generator.sol\n * @author: -\n * @vulnerable_at_lines: 12,18,20,22\n */\n\npragma solidity ^0.4.25;\n\n// Based on TheRun contract deployed at 0xcac337492149bDB66b088bf5914beDfBf78cCC18.\ncontract RandomNumberGenerator {\n  // <yes> <report> BAD_RANDOMNESS\n  uint256 private salt =  block.timestamp;\n\n  function random(uint max) view private returns (uint256 result) {\n    // Get the best seed for randomness\n    uint256 x = salt * 100 / max;\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 y = salt * block.number / (salt % 5);\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 seed = block.number / 3 + (salt % 300) + y;\n    // <yes> <report> BAD_RANDOMNESS\n    uint256 h = uint256(blockhash(seed));\n    // Random number between 1 and max\n    return uint256((h / x)) % max + 1;\n  }\n}\n"}}, "settings": {"optimizer": {"enabled": false}, "outputSelection": {"*": {"*": ["evm.bytecode.object"]}}}}