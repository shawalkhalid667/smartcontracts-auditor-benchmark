{"language": "Solidity", "sources": {"access_control_wallet_03_wrong_constructor.sol": {"content": "/*\n * @source: https://smartcontractsecurity.github.io/SWC-registry/docs/SWC-105#wallet-03-wrong-constructorsol\n * @author: -\n * @vulnerable_at_lines: 19,20\n */\n\n pragma solidity ^0.4.24;\n\n /* User can add pay in and withdraw Ether.\n    The constructor is wrongly named, so anyone can become 'creator' and withdraw all funds.\n */\n\n contract Wallet {\n     address creator;\n\n     mapping(address => uint256) balances;\n     \n     // <yes> <report> ACCESS_CONTROL\n     function initWallet() public {\n         creator = msg.sender;\n     }\n\n     function deposit() public payable {\n         assert(balances[msg.sender] + msg.value > balances[msg.sender]);\n         balances[msg.sender] += msg.value;\n     }\n\n     function withdraw(uint256 amount) public {\n         require(amount <= balances[msg.sender]);\n         msg.sender.transfer(amount);\n         balances[msg.sender] -= amount;\n     }\n\n     // In an emergency the owner can migrate  allfunds to a different address.\n\n     function migrateTo(address to) public {\n         require(creator == msg.sender);\n         to.transfer(this.balance);\n     }\n\n }\n"}}, "settings": {"optimizer": {"enabled": false}, "outputSelection": {"*": {"*": ["evm.bytecode.object"]}}}}